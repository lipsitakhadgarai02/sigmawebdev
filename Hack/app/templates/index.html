<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Resume Analyzer</title>
	<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
	<div class="container">
		<h1>Resume Analyzer</h1>
		<p>Upload your resume (PDF, DOCX, or JPG/PNG) to get an instant score and suggestions.</p>
		<form id="upload-form" method="post" action="{{ url_for('main.upload') }}" enctype="multipart/form-data">
			<div id="dropzone" class="dropzone" tabindex="0" role="button" aria-label="Upload PDF or image via drag and drop or click">
				<div class="dz-icon">⬆</div>
				<div class="dz-text">
					<strong>Drag & drop</strong> your PDF/DOCX/JPG/PNG here or <span class="link">browse</span>
					<div class="dz-sub">PDF, DOCX, JPG, PNG • Max 5 MB</div>
				</div>
				<input id="file-input" type="file" name="resume" accept="application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,image/jpeg,image/png" hidden required>
			</div>
			<div class="file-row">
				<div id="file-name" class="file-name">No file selected</div>
				<button id="submit-btn" type="submit" disabled>Analyze</button>
			</div>
		</form>
		{% with messages = get_flashed_messages() %}
			{% if messages %}
				<ul class="flash">
					{% for message in messages %}
						<li>{{ message }}</li>
					{% endfor %}
				</ul>
			{% endif %}
		{% endwith %}

		{% if history_rows %}
			<div style="display:flex; align-items:center; justify-content:space-between; margin-top:24px;">
				<h2 style="margin:0;">Recent Analyses</h2>
				<button id="toggle-history" type="button" class="btn-link">Hide</button>
			</div>
			<div id="history-grid" class="grid">
				{% for r in history_rows %}
					<div class="card history-card">
						<div class="history-top">
							<div class="history-meta">
								<div class="history-name" title="{{ r[1] }}">{{ r[1] }}</div>
								<div class="history-date">{{ r[4] }}</div>
							</div>
							<div class="score-badge small-badge">
								<span class="score-value" style="font-size:24px; color: {{ 'green' if r[2] >= 80 else ('#d97706' if r[2] >= 50 else '#dc2626') }};">{{ r[2] }}</span>
								<span class="score-max">/100</span>
							</div>
						</div>
						<div class="history-words">Words: {{ r[3] }}</div>
					</div>
				{% endfor %}
			</div>
			<p><a href="{{ url_for('main.history') }}">Open full history</a></p>
		{% endif %}
	</div>
<div id="loading" class="overlay" hidden>
	<div class="spinner"></div>
	<div class="overlay-text">Analyzing your resume…</div>
</div>
<script src="{{ url_for('static', filename='app.js') }}"></script>
<script>
	(function(){
		var btn = document.getElementById('toggle-history');
		var grid = document.getElementById('history-grid');
		if(!btn || !grid) return;
		btn.addEventListener('click', function(){
			var hidden = grid.style.display === 'none';
			grid.style.display = hidden ? '' : 'none';
			btn.textContent = hidden ? 'Hide' : 'Show';
		});
	})();
</script>
</body>
</html>


